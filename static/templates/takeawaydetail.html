<!DOCTYPE html>
{% extends 'basedetail.html' %}
{% load staticfiles %}
{% block content %}
                      <div class="row marketing" >
                      <div class="col-md-2 col-md-offset-1">
                      <h3><a href="{% url 'course_detail' course.id %}"> {{ course.course_name }} </a> </h3>
                      </div>
                      <div class="col-md-4 col-md-offset-1">
                      <h3   align="center" ><a href="{% url 'session_detail' session.id %}">{{ session.session_name }}</a></h3>
                      </div>
                      <div class="col-md-2 col-md-offset-1">
                      <h3><a href="{% url 'session_detailall' session.id %}"> Classmate's Notes</a> </h3>
                      </div>
                       </div>    
                           
                           <div class="input-xlarge">
                              <!--<div class="input-group input-group-lg">-->
                              <form action="{% url 'save_notes'  %}" class="input-group input-group-lg" method="post"> {% csrf_token %}
                                  <input type="hidden"  name="session.id"  value="{{ session.id }}" />
                                  <!--<input type="hidden"  name="session.id"  value="${sessionInstance?.id}" />
                                  <input type="hidden"  name="user.id"  value="1" />-->
                              <textarea class="col-xs-12" name="text"  ></textarea>
                              <!--<input type="textarea" name="text"  class="form-control" >--> <!--class="form-control"-->
                              <span class="input-group-addon"><button class="btn-group btn-success" type="submit" name="create" value="Create">post</button></span>
                              </input>
                              </form>
                        </div>
                           
                         <!--<div class="row marketing" >-->
                               
                        
                               <ul class="list-group"> 
                               
                                   {% for notes in sessions_notes_list %}
                               <li class="list-group-item">
                              
                                   <!--<div class="col-md-8 col-md-offset-1">-->
                                    
                                    <p   align="center"> {{ notes.notes |linebreaks }}  - by {{ notes.user }} <span id="votecount{{ notes.id}}" class="badge">{{notes.vote_count}}</span>
                                    {% if user = notes.user %}
                                    <button class="btn-group btn-success" id="make_public{{ notes.id}}" onclick="make_public1({{ notes.id}},'make_public{{ notes.id}}')" >
                                        {% if notes.is_public %} Make Private   {% else  %} Make Public {%  endif  %}</button>
                                    
                                    
                                    {%  endif  %}
                                    <button id="thumbsup{{ notes.id}}" name="foo" value="bar" onclick="vote({{ notes.id}},'thumbsup{{ notes.id}}',1)" >
                                        <img src="{% static "takeaway/media/thumbsup.jpg" %}" alt="submit"
                                             height="30" width="30" />
                                    </button>
                                    
                                   <!-- <button id="thumbsdown{{ notes.id}}" name="foo" value="bar" onclick="vote({{ notes.id}},'thumbsdown{{ notes.id}}',-1)">
                                        <img src="http://www.clipartbest.com/cliparts/pT5/eAA/pT5eAAMqc.jpeg" alt="submit"
                                             height="30" width="30"/>
                                    </button>-->
                                    </p> 
                                    
                                   <!--</div>-->
                               </li>
                              
                            {% endfor %}
                                   
                               
                              </ul>
                         <!--</div>-->
                              
 <script type="text/javascript">
   
         $.ajaxSetup({ 
            beforeSend: function(xhr, settings) {
                function getCookie(name) {
                    var cookieValue = null;
                    if (document.cookie && document.cookie != '') {
                        var cookies = document.cookie.split(';');
                        for (var i = 0; i < cookies.length; i++) {
                            var cookie = jQuery.trim(cookies[i]);
                            // Does this cookie string begin with the name we want?
                        if (cookie.substring(0, name.length + 1) == (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
                }
                if (!(/^http:.*/.test(settings.url) || /^https:.*/.test(settings.url))) {
                    // Only send the token to relative URLs i.e. locally.
                    //alert(getCookie('csrftoken'));
                    xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
                }
            } 
       });
//var csrftoken = getCookie('csrftoken');

         function make_public1(takeawayID,button_id) {
            
               $.ajax({
                    type: "GET",
                    url: "/takeaway/notes/makepublic/",
                    data: "takeaway_id="+takeawayID,
                    success: function(data){
                     //console.log(button_id   );
                     //alert(button_id);
                     if (data=='True') {
                         $("#"+button_id).html('Make Private');
                     }else {
                         $("#"+button_id).html('Make Public');
                     }
                     
                       }
                });
         }
         
         function vote(takeawayID,button_id,vote_value) {
            //alert(vote_value)
               $.ajax({
                    type: "POST",
                    url: "/takeaway/notes/vote/",
                    data: {takeaway_id:takeawayID,vote_value:vote_value },
                    success: function(data){
                     //console.log(button_id   );
                     //alert(data);
                     $("#votecount"+takeawayID).html(data);
                     
                     
                       }
                });
         }
         
           
       
</script>        
                           
                 {% endblock %}
                 


